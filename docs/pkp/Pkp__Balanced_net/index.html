<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Pkp__Balanced_net (pkp.Pkp__Balanced_net)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">pkp</a> &#x00BB; Pkp__Balanced_net</nav><h1>Module <code>Pkp__Balanced_net</code></h1><p>This module provides key functions for simulating the classical «balanced ⚖ network». You can create your neural populations using e.g. the <a href="index.html#val-lif"><code>lif</code></a> or <a href="index.html#val-poisson"><code>poisson</code></a> funtions, connect them using <a href="index.html#val-random_connections"><code>random_connections</code></a>, run a network simulation using <a href="index.html#val-simulate"><code>simulate</code></a>, and retrieve spikes / voltages for plotting / further analysis.</p><p>For example:</p><pre><code class="ml">let input = Array.init 1000 (fun _ -&gt; poisson 10.)
let output = Array.init 1 (fun _ -&gt; lif ())

let connections = [ all_to_all_connections ~from:input ~onto:output ~w:0.01 ]

let net = { neurons = [ input; output ]; connections }
let duration = 1.0 (* in seconds *)
let _ = simulate ~duration net

(* simplest possible analysis: what's the output firing rate? *)
let output_rate =
  output.(0)
  |&gt; spikes
  |&gt; List.length
  |&gt; fun x -&gt; float x /. duration</code></pre><dl><dt>see <a href="https://www.jstor.org/stable/pdf/2890956.pdf">https://www.jstor.org/stable/pdf/2890956.pdf</a></dt><dd><p>for the mathematical details in the original Science paper (1996).</p></dd></dl><nav class="toc"><ul><li><a href="#neurons">Neurons</a></li><li><a href="#connections">Connections</a></li><li><a href="#event-based-simulation-of-network-dynamics">Event-based simulation of network dynamics</a></li><li><a href="#dealing-with-spike-trains">Dealing with spike trains</a></li></ul></nav></header><section><header><h2 id="neurons"><a href="#neurons" class="anchor"></a>Neurons</h2></header><dl><dt class="spec type" id="type-neuron"><a href="#type-neuron" class="anchor"></a><code><span class="keyword">type</span> neuron</code></dt></dl><dl><dt class="spec value" id="val-lif"><a href="#val-lif" class="anchor"></a><code><span class="keyword">val</span> lif : <span>?&#8288;tau:float</span> <span>&#45;&gt;</span> <span>?&#8288;tau_refr:float</span> <span>&#45;&gt;</span> <span>?&#8288;threshold:float</span> <span>&#45;&gt;</span> <span>?&#8288;axon_delay:float</span> <span>&#45;&gt;</span> <span>?&#8288;log_voltage:bool</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-neuron">neuron</a></code></dt><dd><p>Creates a leaky integrate-and-fire (LIF) neuron;</p><dl><dt>parameter tau</dt><dd><p>membrane time constant (default: 20E-3 s)</p></dd></dl><dl><dt>parameter tau_refr</dt><dd><p>absolute refractory time constant (default: 5E-3 s)</p></dd></dl><dl><dt>parameter threshold</dt><dd><p>firing threshold (default: 1.0)</p></dd></dl><dl><dt>parameter axon_delay</dt><dd><p>(default: uniformly drawn at random between 0 and 2E-3 s)</p></dd></dl><dl><dt>parameter log_voltage</dt><dd><p>whether the membrane potential should be loged (e.g. for plotting later; default: <code>true</code>)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-poisson"><a href="#val-poisson" class="anchor"></a><code><span class="keyword">val</span> poisson : float <span>&#45;&gt;</span> <a href="index.html#type-neuron">neuron</a></code></dt><dd><p><code>poisson rate</code> creates a &quot;Poisson neuron&quot;, i.e. a fake neuron that simply emits action potentials like a Poisson process with rate <code>rate</code> (in Hz)</p></dd></dl><dl><dt class="spec value" id="val-spikes"><a href="#val-spikes" class="anchor"></a><code><span class="keyword">val</span> spikes : <a href="index.html#type-neuron">neuron</a> <span>&#45;&gt;</span> <span>float list</span></code></dt><dd><p>Retrieve all the spike times of a neuron after simulation</p></dd></dl><dl><dt class="spec value" id="val-voltage_trace"><a href="#val-voltage_trace" class="anchor"></a><code><span class="keyword">val</span> voltage_trace : <span>?&#8288;dt:float</span> <span>&#45;&gt;</span> <span>duration:float</span> <span>&#45;&gt;</span> <a href="index.html#type-neuron">neuron</a> <span>&#45;&gt;</span> Owl.Mat.mat</code></dt><dd><p>Retrieve the voltage trace of a neuron after simulation; will fail for a Poisson neuron which has no voltage</p></dd></dl></section><section><header><h2 id="connections"><a href="#connections" class="anchor"></a>Connections</h2></header><dl><dt class="spec type" id="type-connections"><a href="#type-connections" class="anchor"></a><code><span class="keyword">type</span> connections</code></dt></dl><dl><dt class="spec value" id="val-all_to_all_connections"><a href="#val-all_to_all_connections" class="anchor"></a><code><span class="keyword">val</span> all_to_all_connections : <span>from:<span><a href="index.html#type-neuron">neuron</a> array</span></span> <span>&#45;&gt;</span> <span>onto:<span><a href="index.html#type-neuron">neuron</a> array</span></span> <span>&#45;&gt;</span> <span>w:float</span> <span>&#45;&gt;</span> <span><a href="index.html#type-connections">connections</a> array</span></code></dt><dd><p><code>all_to_all_connections from onto k w</code> creates a set of connections such that any neuron in the <code>from</code> population connects to all neurons in the <code>onto</code> population; all synaptic weights are set to <code>w</code></p></dd></dl><dl><dt class="spec value" id="val-random_connections"><a href="#val-random_connections" class="anchor"></a><code><span class="keyword">val</span> random_connections : <span>from:<span><a href="index.html#type-neuron">neuron</a> array</span></span> <span>&#45;&gt;</span> <span>onto:<span><a href="index.html#type-neuron">neuron</a> array</span></span> <span>&#45;&gt;</span> <span>k:int</span> <span>&#45;&gt;</span> <span>w:float</span> <span>&#45;&gt;</span> <span><a href="index.html#type-connections">connections</a> array</span></code></dt><dd><p><code>random_connections from onto k w</code> creates a set of random connections such that any neuron in the <code>from</code> population connects to exactly <code>k</code> neurons randomly chosen (without replacement) from the <code>onto</code> population; all synaptic weights are set to <code>w</code></p></dd></dl></section><section><header><h2 id="event-based-simulation-of-network-dynamics"><a href="#event-based-simulation-of-network-dynamics" class="anchor"></a>Event-based simulation of network dynamics</h2></header><dl><dt class="spec type" id="type-network"><a href="#type-network" class="anchor"></a><code><span class="keyword">type</span> network</code><code> = </code><code>{</code><table class="record"><tr id="type-network.neurons" class="anchored"><td class="def field"><a href="#type-network.neurons" class="anchor"></a><code>neurons : <span><span><a href="index.html#type-neuron">neuron</a> array</span> list</span>;</code></td></tr><tr id="type-network.connections" class="anchored"><td class="def field"><a href="#type-network.connections" class="anchor"></a><code>connections : <span><span><a href="index.html#type-connections">connections</a> array</span> list</span>;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-simulate"><a href="#val-simulate" class="anchor"></a><code><span class="keyword">val</span> simulate : <span>?&#8288;display:bool</span> <span>&#45;&gt;</span> <span>duration:float</span> <span>&#45;&gt;</span> <a href="index.html#type-network">network</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>simulate net duration</code> simulates the dynamics of <code>net</code> for <code>duration</code> seconds; optional parameter <code>display</code> (default: <code>false</code>) can be set to true to display simulation progress.</p></dd></dl></section><section><header><h2 id="dealing-with-spike-trains"><a href="#dealing-with-spike-trains" class="anchor"></a>Dealing with spike trains</h2></header><dl><dt class="spec value" id="val-raster"><a href="#val-raster" class="anchor"></a><code><span class="keyword">val</span> raster : <span><span>float list</span> array</span> <span>&#45;&gt;</span> Owl.Mat.mat</code></dt><dd><p>Converts an array of spike list (each list corresponding to a particular neuron) into a matrix with two columns: (spike time, neuron index). Such a matrix can then easily be plotted as dots -- this is what neuroscientists call a &quot;spike raster&quot;</p></dd></dl><dl><dt class="spec value" id="val-plottable_voltage"><a href="#val-plottable_voltage" class="anchor"></a><code><span class="keyword">val</span> plottable_voltage : <span>?&#8288;style:string</span> <span>&#45;&gt;</span> <span>duration:float</span> <span>&#45;&gt;</span> <a href="index.html#type-neuron">neuron</a> <span>&#45;&gt;</span> Gp.item</code></dt><dd><p>Constructs a readily-plottable <code>Gp.item</code> voltage trace for a given neuron.</p></dd></dl><dl><dt class="spec value" id="val-plottable_spikes"><a href="#val-plottable_spikes" class="anchor"></a><code><span class="keyword">val</span> plottable_spikes : <span>?&#8288;bar_height:float</span> <span>&#45;&gt;</span> <span>?&#8288;style:string</span> <span>&#45;&gt;</span> <a href="index.html#type-neuron">neuron</a> <span>&#45;&gt;</span> Gp.item</code></dt><dd><p>Constructs a readily-plottable <code>Gp.item</code> spike train for a given neuron. Spikes are displayed as bars going from 0 to some tunable height.</p></dd></dl><dl><dt class="spec value" id="val-discard"><a href="#val-discard" class="anchor"></a><code><span class="keyword">val</span> discard : <span>first:float</span> <span>&#45;&gt;</span> <span>float list</span> <span>&#45;&gt;</span> <span>float list</span></code></dt><dd><p>Discard the first <code>first</code> seconds of a spike train</p></dd></dl><dl><dt class="spec value" id="val-fano_factor"><a href="#val-fano_factor" class="anchor"></a><code><span class="keyword">val</span> fano_factor : <span>window:float</span> <span>&#45;&gt;</span> <span>float list</span> <span>&#45;&gt;</span> float</code></dt><dd><p>Estimates the Fano factor from a long spike train; spikes are counted in a window of duration <code>window</code> seconds.</p></dd></dl></section></div></body></html>